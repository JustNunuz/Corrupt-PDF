from reportlab.pdfgen import canvas
from PyPDF2 import PdfReader, PdfWriter
from PyPDF2.generic import DictionaryObject, NameObject, TextStringObject

# Path to save the main PDF
output_pdf = "main_document_with_links.pdf"

# Function to create linked PDF documents
def create_linked_pdfs():
    # Create linked_document1.pdf
    with open("linked_document1.pdf", "wb") as f:
        c1 = canvas.Canvas(f)
        c1.drawString(100, 750, "This is Linked Document 1")
        c1.showPage()
        c1.save()

    # Create linked_document2.pdf
    with open("linked_document2.pdf", "wb") as f:
        c2 = canvas.Canvas(f)
        c2.drawString(100, 750, "This is Linked Document 2")
        c2.showPage()
        c2.save()

    print("Linked documents created: linked_document1.pdf and linked_document2.pdf")

# Function to create the main PDF with links to linked_document1.pdf and linked_document2.pdf
def create_pdf_with_links(pdf_path):
    # Create the main PDF document
    c = canvas.Canvas(pdf_path)
    
    # Add title and link descriptions
    c.drawString(100, 750, "Main PDF Document with Links to Other PDFs")
    c.drawString(100, 700, "Click here to open Linked Document 1")
    c.drawString(100, 650, "Click here to open Linked Document 2")
    
    # Define clickable areas with links to the other PDFs
    c.linkURL("linked_document1.pdf", (100, 695, 300, 715), relative=True)
    c.linkURL("linked_document2.pdf", (100, 645, 300, 665), relative=True)
    
    # Save the main PDF
    c.showPage()
    c.save()
    print("Main PDF created with links to linked documents")

# Main execution
if __name__ == "__main__":
    # Create the linked PDFs first
    create_linked_pdfs()
    
    # Then create the main PDF with links to the linked PDFs
    create_pdf_with_links(output_pdf)
